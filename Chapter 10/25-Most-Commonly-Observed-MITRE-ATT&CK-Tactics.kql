let totalCount = toscalar(
    SecurityAlert
    | where TimeGenerated > ago(90d)
    | where isnotempty(Tactics)
    | mv-expand tactic = split(Tactics, ", ")
    | summarize Total = count()
);
SecurityAlert
| where TimeGenerated > ago(90d)
| where isnotempty(Tactics)
| mv-expand tactic = split(Tactics, ", ")
| summarize Count = count() by tostring(tactic)
| extend Percentage = strcat(round(Count * 100.0 / totalCount, 2),'%')
| extend TacticEmoji = case(
    tactic == "InitialAccess", "ğŸšª",
    tactic == "Execution", "ğŸ’¥",
    tactic == "Persistence", "ğŸ“Œ",
    tactic == "PrivilegeEscalation", "ğŸš€",
    tactic == "DefenseEvasion", "ğŸ•µï¸",
    tactic == "CredentialAccess", "ğŸ”‘",
    tactic == "Discovery", "ğŸ”",
    tactic == "LateralMovement", "ğŸ”„",
    tactic == "Collection", "ğŸ“‚",
    tactic == "Exfiltration", "",
    tactic == "Impact", "âš¡",
    tactic == "CommandAndControl", "ğŸ“¡",
    "â“"  // Default emoji for unknown tactics
)
| project Tactic = strcat(TacticEmoji, " ", tactic), Count, Percentage
| sort by Count desc
| top 10 by Count
